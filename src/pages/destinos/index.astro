---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/layout/Header.astro';
import Footer from '../../components/layout/Footer.astro';
import DestinationCard from '../../components/destinations/DestinationCard.astro';
import DestinationFilters from '../../components/destinations/DestinationFilters.astro';
import { getCollection } from 'astro:content';

// Obtener todos los destinos
const allDestinations = await getCollection('destinations');
const destinations = allDestinations.map(entry => ({...entry.data, slug: entry.slug}));

// Filtrar por tipo
const nationalDestinations = destinations.filter(dest => dest.type === 'nacional').slice(0, 6);
const internationalDestinations = destinations.filter(dest => dest.type === 'internacional').slice(0, 6);

// Filtrar ofertas
const offerDestinations = destinations.filter(dest => {
  const originalPrice = dest.originalPrice 
    ? (typeof dest.originalPrice === 'string' 
        ? Number(dest.originalPrice) || 0
        : dest.originalPrice) 
    : 0;
  
  return originalPrice > 0 && originalPrice > dest.price || dest.tag === 'Oferta';
}).slice(0, 6);
---

<Layout title="Destinos | AL mundo Tour" description="Explora nuestros destinos nacionales e internacionales y encuentra tu pr√≥xima aventura.">
  <Header />
  
  <main>
    <!-- Hero section -->
    <section class="bg-gradient-to-r from-blue-600 to-blue-800 py-20 pt-32">
      <div class="container mx-auto px-4 text-center">
        <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">Nuestros Destinos</h1>
        <p class="text-xl text-blue-100 max-w-3xl mx-auto">
          Explora nuestra amplia selecci√≥n de destinos nacionales e internacionales para todos los gustos y presupuestos
        </p>
      </div>
    </section>
    
    <!-- Breadcrumbs -->
    <section class="bg-gray-50 py-4 border-b border-gray-200">
      <div class="container mx-auto px-4">
        <div class="flex items-center text-sm text-gray-500">
          <a href="/" class="hover:text-blue-600">Inicio</a>
          <span class="mx-2">‚û°Ô∏è</span>
          <span class="text-gray-700">Destinos</span>
        </div>
      </div>
    </section>
    
    <!-- Categor√≠as principales -->
    <section class="py-12 bg-gray-50">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Explora nuestros destinos</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
          <!-- Destinos Nacionales -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="h-48 relative">
              <img src="/images/uploads/colombia-banner.jpg" alt="Destinos Nacionales" class="w-full h-full object-cover" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end">
                <div class="p-6">
                  <h3 class="text-2xl font-bold text-white mb-2">Destinos Nacionales</h3>
                  <p class="text-white/80 mb-4">Lo mejor de Colombia</p>
                  <a href="/destinos/nacionales" class="inline-block bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                    Ver todos
                  </a>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Destinos Internacionales -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="h-48 relative">
              <img src="/images/uploads/internacional-banner.jpg" alt="Destinos Internacionales" class="w-full h-full object-cover" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end">
                <div class="p-6">
                  <h3 class="text-2xl font-bold text-white mb-2">Destinos Internacionales</h3>
                  <p class="text-white/80 mb-4">Explora el mundo</p>
                  <a href="/destinos/internacionales" class="inline-block bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                    Ver todos
                  </a>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Ofertas -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="h-48 relative">
              <img src="/images/uploads/ofertas-banner.jpg" alt="Ofertas Especiales" class="w-full h-full object-cover" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end">
                <div class="p-6">
                  <h3 class="text-2xl font-bold text-white mb-2">Ofertas Especiales</h3>
                  <p class="text-white/80 mb-4">Promociones exclusivas</p>
                  <a href="/promociones" class="inline-block bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors">
                    Ver ofertas
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Explorar por tipo de experiencia -->
        <h3 class="text-2xl font-bold text-center text-gray-900 mb-6">Explora por tipo de experiencia</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
          <a href="/destinos/tag/aventura" class="bg-white rounded-lg shadow-md p-6 flex items-center hover:shadow-lg transition-shadow">
            <div class="bg-green-100 p-3 rounded-full mr-4">
              <span class="text-green-600 text-2xl">üèîÔ∏è</span>
            </div>
            <div>
              <h4 class="font-bold text-gray-900">Aventura</h4>
              <p class="text-sm text-gray-600">Experiencias emocionantes</p>
            </div>
          </a>
          
          <a href="/destinos/tag/playa" class="bg-white rounded-lg shadow-md p-6 flex items-center hover:shadow-lg transition-shadow">
            <div class="bg-cyan-100 p-3 rounded-full mr-4">
              <span class="text-cyan-600 text-2xl">üèñÔ∏è</span>
            </div>
            <div>
              <h4 class="font-bold text-gray-900">Playa</h4>
              <p class="text-sm text-gray-600">Relax junto al mar</p>
            </div>
          </a>
          
          <a href="/destinos/tag/rom√°ntico" class="bg-white rounded-lg shadow-md p-6 flex items-center hover:shadow-lg transition-shadow">
            <div class="bg-pink-100 p-3 rounded-full mr-4">
              <span class="text-pink-600 text-2xl">‚ù§Ô∏è</span>
            </div>
            <div>
              <h4 class="font-bold text-gray-900">Rom√°ntico</h4>
              <p class="text-sm text-gray-600">Escapadas en pareja</p>
            </div>
          </a>
          
          <a href="/destinos/tag/cultural" class="bg-white rounded-lg shadow-md p-6 flex items-center hover:shadow-lg transition-shadow">
            <div class="bg-purple-100 p-3 rounded-full mr-4">
              <span class="text-purple-600 text-2xl">üèõÔ∏è</span>
            </div>
            <div>
              <h4 class="font-bold text-gray-900">Cultural</h4>
              <p class="text-sm text-gray-600">Historia y patrimonio</p>
            </div>
          </a>
        </div>
      </div>
    </section>
    
    <!-- Todos los destinos con filtros -->
    <section class="py-12">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Todos nuestros destinos</h2>
        
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
          <!-- Filtros -->
          <div class="lg:col-span-1">
            <DestinationFilters type="all" />
          </div>
          
          <!-- Lista de destinos -->
          <div class="lg:col-span-3">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              {destinations.map(destination => (
                <DestinationCard destination={destination} />
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <Footer />
</Layout>